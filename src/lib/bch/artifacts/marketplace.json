{
  "contractName": "Marketplace",
  "constructorInputs": [
    {
      "name": "sellerPkh",
      "type": "bytes20"
    },
    {
      "name": "price",
      "type": "int"
    },
    {
      "name": "creatorPkh",
      "type": "bytes20"
    },
    {
      "name": "royaltyBasisPoints",
      "type": "int"
    }
  ],
  "abi": [
    {
      "name": "buy",
      "inputs": []
    },
    {
      "name": "cancel",
      "inputs": [
        {
          "name": "pk",
          "type": "pubkey"
        },
        {
          "name": "s",
          "type": "sig"
        }
      ]
    }
  ],
  "bytecode": "OP_4 OP_PICK OP_0 OP_NUMEQUAL OP_IF OP_OVER OP_4 OP_ROLL OP_MUL 1027 OP_DIV OP_ROT OP_OVER OP_SUB 76a914 OP_3 OP_ROLL OP_CAT 88ac OP_CAT OP_0 OP_OUTPUTBYTECODE OP_EQUALVERIFY OP_0 OP_OUTPUTVALUE OP_LESSTHANOREQUAL OP_VERIFY 76a914 OP_ROT OP_CAT 88ac OP_CAT OP_1 OP_OUTPUTBYTECODE OP_EQUALVERIFY OP_1 OP_OUTPUTVALUE OP_LESSTHANOREQUAL OP_VERIFY OP_2 OP_OUTPUTTOKENCATEGORY OP_INPUTINDEX OP_UTXOTOKENCATEGORY OP_EQUAL OP_NIP OP_ELSE OP_4 OP_ROLL OP_1 OP_NUMEQUALVERIFY OP_4 OP_PICK OP_HASH160 OP_EQUALVERIFY OP_4 OP_ROLL OP_4 OP_ROLL OP_CHECKSIG OP_NIP OP_NIP OP_NIP OP_ENDIF",
  "source": "// BAZAAR - Fixed Price NFT Marketplace Contract\n// BCH Chipnet - CashScript v0.10+\n// Atomic swap: NFT for BCH with enforced creator royalties\n\npragma cashscript >=0.10.0;\n\ncontract Marketplace(\n    bytes20 sellerPkh,\n    int price,\n    bytes20 creatorPkh,\n    int royaltyBasisPoints\n) {\n    // Anyone can buy the listed NFT by paying the correct price\n    // Enforces: seller gets paid, creator gets royalty, NFT transfers to buyer\n    function buy() {\n        // Calculate royalty and seller proceeds\n        int royaltyAmount = price * royaltyBasisPoints / 10000;\n        int sellerAmount = price - royaltyAmount;\n\n        // Output 0: Seller receives payment minus royalty\n        bytes25 sellerLockingBytecode = new LockingBytecodeP2PKH(sellerPkh);\n        require(tx.outputs[0].lockingBytecode == sellerLockingBytecode);\n        require(tx.outputs[0].value >= sellerAmount);\n\n        // Output 1: Creator receives royalty payment\n        bytes25 creatorLockingBytecode = new LockingBytecodeP2PKH(creatorPkh);\n        require(tx.outputs[1].lockingBytecode == creatorLockingBytecode);\n        require(tx.outputs[1].value >= royaltyAmount);\n\n        // Output 2: NFT goes to buyer (token category must be preserved)\n        // The buyer's address is implicit (whoever constructed the transaction)\n        require(\n            tx.outputs[2].tokenCategory\n            == tx.inputs[this.activeInputIndex].tokenCategory\n        );\n    }\n\n    // Seller can cancel the listing and reclaim their NFT\n    function cancel(pubkey pk, sig s) {\n        require(hash160(pk) == sellerPkh);\n        require(checkSig(s, pk));\n    }\n}\n",
  "debug": {
    "bytecode": "5479009c6378547a95021027967b78940376a914537a7e0288ac7e00cd8800cca1690376a9147b7e0288ac7e51cd8851cca16952d1c0ce877767547a519d5479a988547a547aac77777768",
    "sourceMap": "15:4:36:5;;;;;17:28:17:33;:36::54;;:28:::1;:57::62:0;:28:::1;18:27:18:32:0;:35::48;:27:::1;21:40:21:75:0;:65::74;;:40::75:1;;;22:27:22:28:0;:16::45:1;:8::72;23:27:23:28:0;:16::35:1;:::51;:8::53;26:41:26:77:0;:66::76;:41::77:1;;;27:27:27:28:0;:16::45:1;:8::73;28:27:28:28:0;:16::35:1;:::52;:8::54;33:23:33:24:0;:12::39:1;34:25:34:46:0;:15::61:1;32:8:35:10;15:4:36:5;;39::42::0;;;;40:24:40:26;;:16::27:1;:8::42;41:25:41:26:0;;:28::30;;:8::33:1;39:4:42:5;;;7:0:43:1",
    "logs": [],
    "requires": [
      {
        "ip": 26,
        "line": 22
      },
      {
        "ip": 30,
        "line": 23
      },
      {
        "ip": 38,
        "line": 27
      },
      {
        "ip": 42,
        "line": 28
      },
      {
        "ip": 48,
        "line": 32
      },
      {
        "ip": 57,
        "line": 40
      },
      {
        "ip": 63,
        "line": 41
      }
    ]
  },
  "compiler": {
    "name": "cashc",
    "version": "0.12.1"
  },
  "updatedAt": "2026-02-11T03:13:59.262Z"
}