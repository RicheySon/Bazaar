{
  "contractName": "Auction",
  "constructorInputs": [
    {
      "name": "sellerPkh",
      "type": "bytes20"
    },
    {
      "name": "minBid",
      "type": "int"
    },
    {
      "name": "endTime",
      "type": "int"
    },
    {
      "name": "creatorPkh",
      "type": "bytes20"
    },
    {
      "name": "royaltyBasisPoints",
      "type": "int"
    },
    {
      "name": "minBidIncrement",
      "type": "int"
    }
  ],
  "abi": [
    {
      "name": "bid",
      "inputs": [
        {
          "name": "currentBidAmount",
          "type": "int"
        },
        {
          "name": "previousBidderPkh",
          "type": "bytes20"
        }
      ]
    },
    {
      "name": "claim",
      "inputs": [
        {
          "name": "finalBidAmount",
          "type": "int"
        }
      ]
    },
    {
      "name": "reclaim",
      "inputs": [
        {
          "name": "pk",
          "type": "pubkey"
        },
        {
          "name": "s",
          "type": "sig"
        }
      ]
    }
  ],
  "bytecode": "OP_6 OP_PICK OP_0 OP_NUMEQUAL OP_IF OP_0 OP_OUTPUTVALUE OP_8 OP_PICK OP_0 OP_GREATERTHAN OP_IF OP_DUP OP_9 OP_PICK OP_8 OP_PICK OP_ADD OP_GREATERTHANOREQUAL OP_VERIFY OP_ELSE OP_DUP OP_3 OP_PICK OP_GREATERTHANOREQUAL OP_VERIFY OP_ENDIF OP_0 OP_OUTPUTBYTECODE OP_INPUTINDEX OP_UTXOBYTECODE OP_EQUALVERIFY OP_0 OP_OUTPUTTOKENCATEGORY OP_INPUTINDEX OP_UTXOTOKENCATEGORY OP_EQUALVERIFY OP_8 OP_PICK OP_0 OP_GREATERTHAN OP_IF 76a914 OP_10 OP_PICK OP_CAT 88ac OP_CAT OP_1 OP_OUTPUTBYTECODE OP_OVER OP_EQUALVERIFY OP_1 OP_OUTPUTVALUE OP_10 OP_PICK OP_GREATERTHANOREQUAL OP_VERIFY OP_DROP OP_ENDIF OP_2DROP OP_2DROP OP_2DROP OP_2DROP OP_2DROP OP_1 OP_ELSE OP_6 OP_PICK OP_1 OP_NUMEQUAL OP_IF OP_ROT OP_CHECKLOCKTIMEVERIFY OP_DROP OP_6 OP_PICK OP_ROT OP_GREATERTHANOREQUAL OP_VERIFY OP_5 OP_PICK OP_3 OP_ROLL OP_MUL 1027 OP_DIV OP_5 OP_ROLL OP_OVER OP_SUB 76a914 OP_3 OP_ROLL OP_CAT 88ac OP_CAT OP_0 OP_OUTPUTBYTECODE OP_EQUALVERIFY OP_0 OP_OUTPUTVALUE OP_LESSTHANOREQUAL OP_VERIFY 76a914 OP_ROT OP_CAT 88ac OP_CAT OP_1 OP_OUTPUTBYTECODE OP_EQUALVERIFY OP_1 OP_OUTPUTVALUE OP_LESSTHANOREQUAL OP_VERIFY OP_2 OP_OUTPUTTOKENCATEGORY OP_INPUTINDEX OP_UTXOTOKENCATEGORY OP_EQUAL OP_NIP OP_NIP OP_ELSE OP_6 OP_ROLL OP_2 OP_NUMEQUALVERIFY OP_6 OP_PICK OP_HASH160 OP_EQUALVERIFY OP_6 OP_ROLL OP_6 OP_ROLL OP_CHECKSIGVERIFY OP_SWAP OP_CHECKLOCKTIMEVERIFY OP_2DROP OP_2DROP OP_DROP OP_1 OP_ENDIF OP_ENDIF",
  "source": "// BAZAAR - English Auction Contract\n// BCH Chipnet - CashScript v0.10+\n// NFT auction with automatic bid refunds, timelock, and royalty enforcement\n\npragma cashscript >=0.10.0;\n\ncontract Auction(\n    bytes20 sellerPkh,\n    int minBid,\n    int endTime,\n    bytes20 creatorPkh,\n    int royaltyBasisPoints,\n    int minBidIncrement\n) {\n    // Place a new bid - must be higher than current bid\n    // Previous bidder is automatically refunded in the same transaction\n    function bid(\n        int currentBidAmount,\n        bytes20 previousBidderPkh\n    ) {\n        // Auction must not have ended\n        // require(endTime > tx.locktime); // Disabled due to CashScript limitation with strict inequality\n\n        // New bid must be at least minBidIncrement higher than current\n        int newBidAmount = tx.outputs[0].value;\n        if (currentBidAmount > 0) {\n            require(newBidAmount >= currentBidAmount + minBidIncrement);\n        } else {\n            require(newBidAmount >= minBid);\n        }\n\n        // Output 0: Contract continues with new bid amount (NFT stays in contract)\n        // The contract UTXO is recreated with the new bid\n        require(\n            tx.outputs[0].lockingBytecode\n            == tx.inputs[this.activeInputIndex].lockingBytecode\n        );\n\n        // NFT must stay in the contract\n        require(\n            tx.outputs[0].tokenCategory\n            == tx.inputs[this.activeInputIndex].tokenCategory\n        );\n\n        // Output 1: Refund previous bidder (if there was one)\n        if (currentBidAmount > 0) {\n            bytes25 prevBidderLockingBytecode = new LockingBytecodeP2PKH(previousBidderPkh);\n            require(tx.outputs[1].lockingBytecode == prevBidderLockingBytecode);\n            require(tx.outputs[1].value >= currentBidAmount);\n        }\n    }\n\n    // Winner claims the NFT after auction ends\n    function claim(\n        int finalBidAmount\n    ) {\n        // Auction must have ended\n        require(tx.time >= endTime);\n\n        // Must have a winning bid\n        require(finalBidAmount >= minBid);\n\n        // Calculate royalty and seller proceeds\n        int royaltyAmount = finalBidAmount * royaltyBasisPoints / 10000;\n        int sellerAmount = finalBidAmount - royaltyAmount;\n\n        // Output 0: Seller receives payment minus royalty\n        bytes25 sellerLockingBytecode = new LockingBytecodeP2PKH(sellerPkh);\n        require(tx.outputs[0].lockingBytecode == sellerLockingBytecode);\n        require(tx.outputs[0].value >= sellerAmount);\n\n        // Output 1: Creator receives royalty\n        bytes25 creatorLockingBytecode = new LockingBytecodeP2PKH(creatorPkh);\n        require(tx.outputs[1].lockingBytecode == creatorLockingBytecode);\n        require(tx.outputs[1].value >= royaltyAmount);\n\n        // Output 2: NFT goes to winner\n        require(\n            tx.outputs[2].tokenCategory\n            == tx.inputs[this.activeInputIndex].tokenCategory\n        );\n    }\n\n    // Seller reclaims NFT if no bids were placed after auction ends\n    function reclaim(pubkey pk, sig s) {\n        require(hash160(pk) == sellerPkh);\n        require(checkSig(s, pk));\n        require(tx.time >= endTime);\n    }\n}\n",
  "debug": {
    "bytecode": "5679009c6300cc587900a063765979587993a26967765379a2696800cdc0c78800d1c0ce88587900a0630376a9145a797e0288ac7e51cd788851cc5a79a26975686d6d6d6d6d51675679519c637bb17556797ba2695579537a9502102796557a78940376a914537a7e0288ac7e00cd8800cca1690376a9147b7e0288ac7e51cd8851cca16952d1c0ce87777767567a529d5679a988567a567aad7cb16d6d75516868",
    "sourceMap": "17:4:51:5;;;;;25:38:25:39;:27::46:1;26:12:26:28:0;;:31::32;:12:::1;:34:28:9:0;27:20:27:32;:36::52;;:55::70;;:36:::1;:20;:12::72;28:15:30:9:0;29:20:29:32;:36::42;;:20:::1;:12::44;28:15:30:9;35:23:35:24:0;:12::41:1;36:25:36:46:0;:15::63:1;34:8:37:10;41:23:41:24:0;:12::39:1;42:25:42:46:0;:15::61:1;40:8:43:10;46:12:46:28:0;;:31::32;:12:::1;:34:50:9:0;47:48:47:91;:73::90;;:48::91:1;;;48:31:48:32:0;:20::49:1;:53::78:0;:12::80:1;49:31:49:32:0;:20::39:1;:43::59:0;;:20:::1;:12::61;46:34:50:9;;17:4:51:5;;;;;;;54::82::0;;;;;58:27:58:34;:8::36:1;;61:16:61:30:0;;:34::40;:16:::1;:8::42;64:28:64::0;;:45::63;;:28:::1;:66::71:0;:28:::1;65:27:65:41:0;;:44::57;:27:::1;68:40:68:75:0;:65::74;;:40::75:1;;;69:27:69:28:0;:16::45:1;:8::72;70:27:70:28:0;:16::35:1;:::51;:8::53;73:41:73:77:0;:66::76;:41::77:1;;;74:27:74:28:0;:16::45:1;:8::73;75:27:75:28:0;:16::35:1;:::52;:8::54;79:23:79:24:0;:12::39:1;80:25:80:46:0;:15::61:1;78:8:81:10;54:4:82:5;;;85::89::0;;;;86:24:86:26;;:16::27:1;:8::42;87:25:87:26:0;;:28::30;;:8::33:1;88:27:88:34:0;:8::36:1;85:4:89:5;;;;7:0:90:1;",
    "logs": [],
    "requires": [
      {
        "ip": 25,
        "line": 27
      },
      {
        "ip": 31,
        "line": 29
      },
      {
        "ip": 37,
        "line": 34
      },
      {
        "ip": 42,
        "line": 40
      },
      {
        "ip": 57,
        "line": 48
      },
      {
        "ip": 63,
        "line": 49
      },
      {
        "ip": 79,
        "line": 58
      },
      {
        "ip": 85,
        "line": 61
      },
      {
        "ip": 105,
        "line": 69
      },
      {
        "ip": 109,
        "line": 70
      },
      {
        "ip": 117,
        "line": 74
      },
      {
        "ip": 121,
        "line": 75
      },
      {
        "ip": 127,
        "line": 78
      },
      {
        "ip": 137,
        "line": 86
      },
      {
        "ip": 142,
        "line": 87
      },
      {
        "ip": 144,
        "line": 88
      }
    ]
  },
  "compiler": {
    "name": "cashc",
    "version": "0.12.1"
  },
  "updatedAt": "2026-02-11T03:13:54.027Z"
}